-- Crear la base de datos
CREATE DATABASE IF NOT EXISTS internship_students;
USE internship_students;


-- Tabla de Usuario
CREATE TABLE usuario (
    id INT AUTO_INCREMENT PRIMARY KEY,
    email VARCHAR(120) NOT NULL UNIQUE,
    password VARCHAR(100) NOT NULL,
    rol ENUM('ADMIN', 'ESTUDIANTE', 'EMPRESA') NOT NULL,
    fecha_registro TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);


-- Tabla de Instituto
CREATE TABLE instituto (
    id INT AUTO_INCREMENT PRIMARY KEY,
    nombre VARCHAR(150) NOT NULL,
    direccion VARCHAR(200) NOT NULL,
    ciudad VARCHAR(100) NOT NULL,
    provincia VARCHAR(100) NOT NULL,
    codigo_postal VARCHAR(10) NOT NULL,
    telefono VARCHAR(20) NOT NULL,
    email_contacto VARCHAR(120) NOT NULL,
    web VARCHAR(150),
    descripcion TEXT
);


-- Tabla de Ciclo
CREATE TABLE ciclo (
    id INT AUTO_INCREMENT PRIMARY KEY,
    nombre VARCHAR(150) NOT NULL,
    descripcion TEXT,
    instituto_id INT NOT NULL,
    FOREIGN KEY (instituto_id) REFERENCES institutos(id) ON DELETE CASCADE
);


-- Tabla de Estudiante
CREATE TABLE estudiante (
    id INT AUTO_INCREMENT PRIMARY KEY,
    usuario_id INT NOT NULL,
    instituto_id INT NOT NULL,
    estudio_id INT NOT NULL,
    nombre VARCHAR(100) NOT NULL,
    apellidos VARCHAR(150) NOT NULL,
    dni VARCHAR(12) NOT NULL,
    descripcion_personal TEXT,
    habilidades TEXT,
    idiomas TEXT,
    experiencia TEXT,
    certificaciones TEXT,
    proyectos TEXT,
    redes_sociales TEXT,
    url_foto_perfil VARCHAR(200),
    url_video_cv VARCHAR(200),
    carta_presentacion VARCHAR(200),
    FOREIGN KEY (usuario_id) REFERENCES usuarios(id) ON DELETE CASCADE,
    FOREIGN KEY (instituto_id) REFERENCES institutos(id) ON DELETE CASCADE,
    FOREIGN KEY (estudio_id) REFERENCES estudios(id) ON DELETE CASCADE
);


-- Tabla de Empresa
CREATE TABLE empresa (
    id INT AUTO_INCREMENT PRIMARY KEY,
    usuario_id INT NOT NULL,
    nombre_empresa VARCHAR(150) NOT NULL,
    cif VARCHAR(15) NOT NULL,
    nombre_responsable VARCHAR(100) NOT NULL,
    nif_responsable VARCHAR(15) NOT NULL,
    direccion VARCHAR(200) NOT NULL,
    localidad VARCHAR(100) NOT NULL,
    provincia VARCHAR(100) NOT NULL,
    sede_practicas VARCHAR(200),
    telefono_contacto VARCHAR(20) NOT NULL,
    email_contacto VARCHAR(120) NOT NULL,
    FOREIGN KEY (usuario_id) REFERENCES usuarios(id) ON DELETE CASCADE
);